using System;
using NUnit.Framework;
using AtaLogger;

namespace AtaLogger.Tests
{
	[TestFixture]
	public class MappingTests
    {
		[Test]
	    public void LoggerSampleMapTest()
	    {
		    var nofsamples = 15;
		    var datasize = nofsamples * (4 + 2);
		    var buffer = new byte[]
		    {
			    0x4a, 0xd4, 0x82, 0x46, 0x71, 0x00,
			    0x0a, 0xd8, 0x82, 0x46, 0x28, 0x00,
			    0xca, 0xdb, 0x82, 0x46, 0x2c, 0x00,
			    0x8a, 0xe0, 0x82, 0x46, 0x34, 0x00,
			    0x4a, 0xe4, 0x82, 0x46, 0x1a, 0x00,
			    0x0a, 0xe8, 0x82, 0x46, 0x26, 0x00,
			    0xca, 0xeb, 0x82, 0x46, 0x35, 0x00,
			    0x8b, 0xf0, 0x82, 0x46, 0x23, 0x00,
			    0x4b, 0xf4, 0x82, 0x46, 0x2a, 0x00,
			    0x0b, 0xf8, 0x82, 0x46, 0x34, 0x00,
			    0xcb, 0xfb, 0x82, 0x46, 0x1f, 0x00,
			    0x8b, 0x00, 0x83, 0x46, 0x2f, 0x00,
			    0x4b, 0x04, 0x83, 0x46, 0x2e, 0x00,
			    0x0c, 0x08, 0x83, 0x46, 0x23, 0x00,
			    0xcc, 0x0b, 0x83, 0x46, 0x33, 0x00,
		    };
			Assert.AreEqual(datasize,buffer.Length);

			var data = Utils.MapArray<LoggerSamplePacket>(buffer, nofsamples);
			Assert.AreEqual(15,data.Length);

			Assert.AreEqual(new DateTime(2017,10,01,13,17,10), data[0].TimeStamp.ConvertToDateTime());

	    }
    }
}
